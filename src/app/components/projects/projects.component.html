<section id="projects" class="py-16 md:py-24" appAnimateOnScroll>
  <div class="container mx-auto px-4">
    <h2 class="text-3xl md:text-4xl font-bold text-center mb-4">{{ 'PROJECTS.TITLE' | translate }}</h2>
    <p class="text-center text-lg text-gray-600 dark:text-gray-550 mb-12 max-w-3xl mx-auto">{{ 'PROJECTS.SUBTITLE' | translate }}</p>

    <!-- Filtres par technologie -->
    <div class="flex justify-center flex-wrap gap-2 mb-12">
      <button (click)="filterProjects('Tous')" [class.active]="activeFilter === 'Tous'" class="filter-button">{{ 'PROJECTS.FILTER_ALL' | translate }}</button>
      <button *ngFor="let tech of technologies" (click)="filterProjects(tech)" [class.active]="activeFilter === tech" class="filter-button">
        {{ tech }}
      </button>
    </div>

    <!-- Grille des projets filtrés -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" [@listAnimation]="filteredProjects.length">
      <mat-card *ngFor="let project of filteredProjects" class="project-card">
        
        <!-- Conteneur pour l'image et le badge de statut -->
        <div class="project-thumbnail-container">
          <img mat-card-image [src]="project.data.IMAGE_URLS[0]" [alt]="project.data.TITLE" class="project-thumbnail" (click)="openLightbox(project.data.IMAGE_URLS, 0)">
          <!-- Badge de statut -->
          <span class="status-badge" [ngClass]="'status-' + project.data.STATUS.split(' ')[0].toLowerCase()">
            {{ project.data.STATUS }}
          </span>
        </div>
        
        <mat-card-header class="!pt-6">
          <div>
            <p class="text-sm font-semibold text-primary">{{ project.data.TYPE }}</p>
            <mat-card-title class="!text-xl !font-bold">{{ project.data.TITLE }}</mat-card-title>
          </div>
        </mat-card-header>

        <mat-card-content class="!pt-4 flex-grow">
          <p class="text-gray-600 dark:text-gray-500 mb-4">{{ project.data.DESCRIPTION }}</p>
          
          <h4 class="font-semibold mb-2">Points forts :</h4>
          <ul class="list-disc list-inside text-gray-600 dark:text-gray-500">
            <li *ngFor="let point of project.data.POINTS_FORTS">{{ point }}</li>
          </ul>
        </mat-card-content>

        <mat-card-actions class="!p-4 !pt-2 flex flex-wrap gap-2">
          <a *ngIf="project.projectUrl && project.projectUrl !== '#'" [href]="project.projectUrl" target="_blank" mat-flat-button color="primary">Voir la Démo</a>
          <a *ngIf="project.repoUrl && project.repoUrl !== '#'" [href]="project.repoUrl" target="_blank" mat-stroked-button>Code Source</a>
        </mat-card-actions>
      </mat-card>
    </div>

    <!-- Pagination (simplifiée pour l'instant) -->
    <!-- <div class="text-center mt-12">
      <button mat-raised-button>{{ 'PROJECTS.LOAD_MORE' | translate }}</button>
    </div> -->
  </div>
</section>

<!-- =============================================================== -->
<!-- LIGHTBOX (visionneuse d'images) -->
<!-- =============================================================== -->
<div *ngIf="isLightboxOpen" class="lightbox-backdrop" (click)="closeLightbox()" [@lightboxAnimation]>
  <button mat-icon-button class="lightbox-close-button" (click)="closeLightbox()">
    <mat-icon>close</mat-icon>
  </button>
  
  <div class="lightbox-content" (click)="$event.stopPropagation()">
    <button mat-icon-button class="lightbox-nav-button prev" (click)="prevLightboxImage()">
      <mat-icon>keyboard_arrow_left</mat-icon>
    </button>
    
    <img [src]="lightboxImages[currentLightboxImageIndex]" class="lightbox-image" alt="Project screenshot">
    
    <button mat-icon-button class="lightbox-nav-button next" (click)="nextLightboxImage()">
      <mat-icon>keyboard_arrow_right</mat-icon>
    </button>
  </div>
</div>